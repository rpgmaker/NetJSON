using System;
using System.Runtime.InteropServices;

namespace NetJSON {
    public unsafe static class IntUtility {
        const ulong ATOI_TAB_SZ = 10000UL;
        const ulong ATOI_TAB_SZ_LOG = 4UL;

        static string[] digits_string = new string[]{
            "0000000100020003000400050006000700080009",
        "0010001100120013001400150016001700180019",
        "0020002100220023002400250026002700280029",
        "0030003100320033003400350036003700380039",
        "0040004100420043004400450046004700480049",
        "0050005100520053005400550056005700580059",
        "0060006100620063006400650066006700680069",
        "0070007100720073007400750076007700780079",
        "0080008100820083008400850086008700880089",
        "0090009100920093009400950096009700980099",
        "0100010101020103010401050106010701080109",
        "0110011101120113011401150116011701180119",
        "0120012101220123012401250126012701280129",
        "0130013101320133013401350136013701380139",
        "0140014101420143014401450146014701480149",
        "0150015101520153015401550156015701580159",
        "0160016101620163016401650166016701680169",
        "0170017101720173017401750176017701780179",
        "0180018101820183018401850186018701880189",
        "0190019101920193019401950196019701980199",
        "0200020102020203020402050206020702080209",
        "0210021102120213021402150216021702180219",
        "0220022102220223022402250226022702280229",
        "0230023102320233023402350236023702380239",
        "0240024102420243024402450246024702480249",
        "0250025102520253025402550256025702580259",
        "0260026102620263026402650266026702680269",
        "0270027102720273027402750276027702780279",
        "0280028102820283028402850286028702880289",
        "0290029102920293029402950296029702980299",
        "0300030103020303030403050306030703080309",
        "0310031103120313031403150316031703180319",
        "0320032103220323032403250326032703280329",
        "0330033103320333033403350336033703380339",
        "0340034103420343034403450346034703480349",
        "0350035103520353035403550356035703580359",
        "0360036103620363036403650366036703680369",
        "0370037103720373037403750376037703780379",
        "0380038103820383038403850386038703880389",
        "0390039103920393039403950396039703980399",
        "0400040104020403040404050406040704080409",
        "0410041104120413041404150416041704180419",
        "0420042104220423042404250426042704280429",
        "0430043104320433043404350436043704380439",
        "0440044104420443044404450446044704480449",
        "0450045104520453045404550456045704580459",
        "0460046104620463046404650466046704680469",
        "0470047104720473047404750476047704780479",
        "0480048104820483048404850486048704880489",
        "0490049104920493049404950496049704980499",
        "0500050105020503050405050506050705080509",
        "0510051105120513051405150516051705180519",
        "0520052105220523052405250526052705280529",
        "0530053105320533053405350536053705380539",
        "0540054105420543054405450546054705480549",
        "0550055105520553055405550556055705580559",
        "0560056105620563056405650566056705680569",
        "0570057105720573057405750576057705780579",
        "0580058105820583058405850586058705880589",
        "0590059105920593059405950596059705980599",
        "0600060106020603060406050606060706080609",
        "0610061106120613061406150616061706180619",
        "0620062106220623062406250626062706280629",
        "0630063106320633063406350636063706380639",
        "0640064106420643064406450646064706480649",
        "0650065106520653065406550656065706580659",
        "0660066106620663066406650666066706680669",
        "0670067106720673067406750676067706780679",
        "0680068106820683068406850686068706880689",
        "0690069106920693069406950696069706980699",
        "0700070107020703070407050706070707080709",
        "0710071107120713071407150716071707180719",
        "0720072107220723072407250726072707280729",
        "0730073107320733073407350736073707380739",
        "0740074107420743074407450746074707480749",
        "0750075107520753075407550756075707580759",
        "0760076107620763076407650766076707680769",
        "0770077107720773077407750776077707780779",
        "0780078107820783078407850786078707880789",
        "0790079107920793079407950796079707980799",
        "0800080108020803080408050806080708080809",
        "0810081108120813081408150816081708180819",
        "0820082108220823082408250826082708280829",
        "0830083108320833083408350836083708380839",
        "0840084108420843084408450846084708480849",
        "0850085108520853085408550856085708580859",
        "0860086108620863086408650866086708680869",
        "0870087108720873087408750876087708780879",
        "0880088108820883088408850886088708880889",
        "0890089108920893089408950896089708980899",
        "0900090109020903090409050906090709080909",
        "0910091109120913091409150916091709180919",
        "0920092109220923092409250926092709280929",
        "0930093109320933093409350936093709380939",
        "0940094109420943094409450946094709480949",
        "0950095109520953095409550956095709580959",
        "0960096109620963096409650966096709680969",
        "0970097109720973097409750976097709780979",
        "0980098109820983098409850986098709880989",
        "0990099109920993099409950996099709980999",
        "1000100110021003100410051006100710081009",
        "1010101110121013101410151016101710181019",
        "1020102110221023102410251026102710281029",
        "1030103110321033103410351036103710381039",
        "1040104110421043104410451046104710481049",
        "1050105110521053105410551056105710581059",
        "1060106110621063106410651066106710681069",
        "1070107110721073107410751076107710781079",
        "1080108110821083108410851086108710881089",
        "1090109110921093109410951096109710981099",
        "1100110111021103110411051106110711081109",
        "1110111111121113111411151116111711181119",
        "1120112111221123112411251126112711281129",
        "1130113111321133113411351136113711381139",
        "1140114111421143114411451146114711481149",
        "1150115111521153115411551156115711581159",
        "1160116111621163116411651166116711681169",
        "1170117111721173117411751176117711781179",
        "1180118111821183118411851186118711881189",
        "1190119111921193119411951196119711981199",
        "1200120112021203120412051206120712081209",
        "1210121112121213121412151216121712181219",
        "1220122112221223122412251226122712281229",
        "1230123112321233123412351236123712381239",
        "1240124112421243124412451246124712481249",
        "1250125112521253125412551256125712581259",
        "1260126112621263126412651266126712681269",
        "1270127112721273127412751276127712781279",
        "1280128112821283128412851286128712881289",
        "1290129112921293129412951296129712981299",
        "1300130113021303130413051306130713081309",
        "1310131113121313131413151316131713181319",
        "1320132113221323132413251326132713281329",
        "1330133113321333133413351336133713381339",
        "1340134113421343134413451346134713481349",
        "1350135113521353135413551356135713581359",
        "1360136113621363136413651366136713681369",
        "1370137113721373137413751376137713781379",
        "1380138113821383138413851386138713881389",
        "1390139113921393139413951396139713981399",
        "1400140114021403140414051406140714081409",
        "1410141114121413141414151416141714181419",
        "1420142114221423142414251426142714281429",
        "1430143114321433143414351436143714381439",
        "1440144114421443144414451446144714481449",
        "1450145114521453145414551456145714581459",
        "1460146114621463146414651466146714681469",
        "1470147114721473147414751476147714781479",
        "1480148114821483148414851486148714881489",
        "1490149114921493149414951496149714981499",
        "1500150115021503150415051506150715081509",
        "1510151115121513151415151516151715181519",
        "1520152115221523152415251526152715281529",
        "1530153115321533153415351536153715381539",
        "1540154115421543154415451546154715481549",
        "1550155115521553155415551556155715581559",
        "1560156115621563156415651566156715681569",
        "1570157115721573157415751576157715781579",
        "1580158115821583158415851586158715881589",
        "1590159115921593159415951596159715981599",
        "1600160116021603160416051606160716081609",
        "1610161116121613161416151616161716181619",
        "1620162116221623162416251626162716281629",
        "1630163116321633163416351636163716381639",
        "1640164116421643164416451646164716481649",
        "1650165116521653165416551656165716581659",
        "1660166116621663166416651666166716681669",
        "1670167116721673167416751676167716781679",
        "1680168116821683168416851686168716881689",
        "1690169116921693169416951696169716981699",
        "1700170117021703170417051706170717081709",
        "1710171117121713171417151716171717181719",
        "1720172117221723172417251726172717281729",
        "1730173117321733173417351736173717381739",
        "1740174117421743174417451746174717481749",
        "1750175117521753175417551756175717581759",
        "1760176117621763176417651766176717681769",
        "1770177117721773177417751776177717781779",
        "1780178117821783178417851786178717881789",
        "1790179117921793179417951796179717981799",
        "1800180118021803180418051806180718081809",
        "1810181118121813181418151816181718181819",
        "1820182118221823182418251826182718281829",
        "1830183118321833183418351836183718381839",
        "1840184118421843184418451846184718481849",
        "1850185118521853185418551856185718581859",
        "1860186118621863186418651866186718681869",
        "1870187118721873187418751876187718781879",
        "1880188118821883188418851886188718881889",
        "1890189118921893189418951896189718981899",
        "1900190119021903190419051906190719081909",
        "1910191119121913191419151916191719181919",
        "1920192119221923192419251926192719281929",
        "1930193119321933193419351936193719381939",
        "1940194119421943194419451946194719481949",
        "1950195119521953195419551956195719581959",
        "1960196119621963196419651966196719681969",
        "1970197119721973197419751976197719781979",
        "1980198119821983198419851986198719881989",
        "1990199119921993199419951996199719981999",
        "2000200120022003200420052006200720082009",
        "2010201120122013201420152016201720182019",
        "2020202120222023202420252026202720282029",
        "2030203120322033203420352036203720382039",
        "2040204120422043204420452046204720482049",
        "2050205120522053205420552056205720582059",
        "2060206120622063206420652066206720682069",
        "2070207120722073207420752076207720782079",
        "2080208120822083208420852086208720882089",
        "2090209120922093209420952096209720982099",
        "2100210121022103210421052106210721082109",
        "2110211121122113211421152116211721182119",
        "2120212121222123212421252126212721282129",
        "2130213121322133213421352136213721382139",
        "2140214121422143214421452146214721482149",
        "2150215121522153215421552156215721582159",
        "2160216121622163216421652166216721682169",
        "2170217121722173217421752176217721782179",
        "2180218121822183218421852186218721882189",
        "2190219121922193219421952196219721982199",
        "2200220122022203220422052206220722082209",
        "2210221122122213221422152216221722182219",
        "2220222122222223222422252226222722282229",
        "2230223122322233223422352236223722382239",
        "2240224122422243224422452246224722482249",
        "2250225122522253225422552256225722582259",
        "2260226122622263226422652266226722682269",
        "2270227122722273227422752276227722782279",
        "2280228122822283228422852286228722882289",
        "2290229122922293229422952296229722982299",
        "2300230123022303230423052306230723082309",
        "2310231123122313231423152316231723182319",
        "2320232123222323232423252326232723282329",
        "2330233123322333233423352336233723382339",
        "2340234123422343234423452346234723482349",
        "2350235123522353235423552356235723582359",
        "2360236123622363236423652366236723682369",
        "2370237123722373237423752376237723782379",
        "2380238123822383238423852386238723882389",
        "2390239123922393239423952396239723982399",
        "2400240124022403240424052406240724082409",
        "2410241124122413241424152416241724182419",
        "2420242124222423242424252426242724282429",
        "2430243124322433243424352436243724382439",
        "2440244124422443244424452446244724482449",
        "2450245124522453245424552456245724582459",
        "2460246124622463246424652466246724682469",
        "2470247124722473247424752476247724782479",
        "2480248124822483248424852486248724882489",
        "2490249124922493249424952496249724982499",
        "2500250125022503250425052506250725082509",
        "2510251125122513251425152516251725182519",
        "2520252125222523252425252526252725282529",
        "2530253125322533253425352536253725382539",
        "2540254125422543254425452546254725482549",
        "2550255125522553255425552556255725582559",
        "2560256125622563256425652566256725682569",
        "2570257125722573257425752576257725782579",
        "2580258125822583258425852586258725882589",
        "2590259125922593259425952596259725982599",
        "2600260126022603260426052606260726082609",
        "2610261126122613261426152616261726182619",
        "2620262126222623262426252626262726282629",
        "2630263126322633263426352636263726382639",
        "2640264126422643264426452646264726482649",
        "2650265126522653265426552656265726582659",
        "2660266126622663266426652666266726682669",
        "2670267126722673267426752676267726782679",
        "2680268126822683268426852686268726882689",
        "2690269126922693269426952696269726982699",
        "2700270127022703270427052706270727082709",
        "2710271127122713271427152716271727182719",
        "2720272127222723272427252726272727282729",
        "2730273127322733273427352736273727382739",
        "2740274127422743274427452746274727482749",
        "2750275127522753275427552756275727582759",
        "2760276127622763276427652766276727682769",
        "2770277127722773277427752776277727782779",
        "2780278127822783278427852786278727882789",
        "2790279127922793279427952796279727982799",
        "2800280128022803280428052806280728082809",
        "2810281128122813281428152816281728182819",
        "2820282128222823282428252826282728282829",
        "2830283128322833283428352836283728382839",
        "2840284128422843284428452846284728482849",
        "2850285128522853285428552856285728582859",
        "2860286128622863286428652866286728682869",
        "2870287128722873287428752876287728782879",
        "2880288128822883288428852886288728882889",
        "2890289128922893289428952896289728982899",
        "2900290129022903290429052906290729082909",
        "2910291129122913291429152916291729182919",
        "2920292129222923292429252926292729282929",
        "2930293129322933293429352936293729382939",
        "2940294129422943294429452946294729482949",
        "2950295129522953295429552956295729582959",
        "2960296129622963296429652966296729682969",
        "2970297129722973297429752976297729782979",
        "2980298129822983298429852986298729882989",
        "2990299129922993299429952996299729982999",
        "3000300130023003300430053006300730083009",
        "3010301130123013301430153016301730183019",
        "3020302130223023302430253026302730283029",
        "3030303130323033303430353036303730383039",
        "3040304130423043304430453046304730483049",
        "3050305130523053305430553056305730583059",
        "3060306130623063306430653066306730683069",
        "3070307130723073307430753076307730783079",
        "3080308130823083308430853086308730883089",
        "3090309130923093309430953096309730983099",
        "3100310131023103310431053106310731083109",
        "3110311131123113311431153116311731183119",
        "3120312131223123312431253126312731283129",
        "3130313131323133313431353136313731383139",
        "3140314131423143314431453146314731483149",
        "3150315131523153315431553156315731583159",
        "3160316131623163316431653166316731683169",
        "3170317131723173317431753176317731783179",
        "3180318131823183318431853186318731883189",
        "3190319131923193319431953196319731983199",
        "3200320132023203320432053206320732083209",
        "3210321132123213321432153216321732183219",
        "3220322132223223322432253226322732283229",
        "3230323132323233323432353236323732383239",
        "3240324132423243324432453246324732483249",
        "3250325132523253325432553256325732583259",
        "3260326132623263326432653266326732683269",
        "3270327132723273327432753276327732783279",
        "3280328132823283328432853286328732883289",
        "3290329132923293329432953296329732983299",
        "3300330133023303330433053306330733083309",
        "3310331133123313331433153316331733183319",
        "3320332133223323332433253326332733283329",
        "3330333133323333333433353336333733383339",
        "3340334133423343334433453346334733483349",
        "3350335133523353335433553356335733583359",
        "3360336133623363336433653366336733683369",
        "3370337133723373337433753376337733783379",
        "3380338133823383338433853386338733883389",
        "3390339133923393339433953396339733983399",
        "3400340134023403340434053406340734083409",
        "3410341134123413341434153416341734183419",
        "3420342134223423342434253426342734283429",
        "3430343134323433343434353436343734383439",
        "3440344134423443344434453446344734483449",
        "3450345134523453345434553456345734583459",
        "3460346134623463346434653466346734683469",
        "3470347134723473347434753476347734783479",
        "3480348134823483348434853486348734883489",
        "3490349134923493349434953496349734983499",
        "3500350135023503350435053506350735083509",
        "3510351135123513351435153516351735183519",
        "3520352135223523352435253526352735283529",
        "3530353135323533353435353536353735383539",
        "3540354135423543354435453546354735483549",
        "3550355135523553355435553556355735583559",
        "3560356135623563356435653566356735683569",
        "3570357135723573357435753576357735783579",
        "3580358135823583358435853586358735883589",
        "3590359135923593359435953596359735983599",
        "3600360136023603360436053606360736083609",
        "3610361136123613361436153616361736183619",
        "3620362136223623362436253626362736283629",
        "3630363136323633363436353636363736383639",
        "3640364136423643364436453646364736483649",
        "3650365136523653365436553656365736583659",
        "3660366136623663366436653666366736683669",
        "3670367136723673367436753676367736783679",
        "3680368136823683368436853686368736883689",
        "3690369136923693369436953696369736983699",
        "3700370137023703370437053706370737083709",
        "3710371137123713371437153716371737183719",
        "3720372137223723372437253726372737283729",
        "3730373137323733373437353736373737383739",
        "3740374137423743374437453746374737483749",
        "3750375137523753375437553756375737583759",
        "3760376137623763376437653766376737683769",
        "3770377137723773377437753776377737783779",
        "3780378137823783378437853786378737883789",
        "3790379137923793379437953796379737983799",
        "3800380138023803380438053806380738083809",
        "3810381138123813381438153816381738183819",
        "3820382138223823382438253826382738283829",
        "3830383138323833383438353836383738383839",
        "3840384138423843384438453846384738483849",
        "3850385138523853385438553856385738583859",
        "3860386138623863386438653866386738683869",
        "3870387138723873387438753876387738783879",
        "3880388138823883388438853886388738883889",
        "3890389138923893389438953896389738983899",
        "3900390139023903390439053906390739083909",
        "3910391139123913391439153916391739183919",
        "3920392139223923392439253926392739283929",
        "3930393139323933393439353936393739383939",
        "3940394139423943394439453946394739483949",
        "3950395139523953395439553956395739583959",
        "3960396139623963396439653966396739683969",
        "3970397139723973397439753976397739783979",
        "3980398139823983398439853986398739883989",
        "3990399139923993399439953996399739983999",
        "4000400140024003400440054006400740084009",
        "4010401140124013401440154016401740184019",
        "4020402140224023402440254026402740284029",
        "4030403140324033403440354036403740384039",
        "4040404140424043404440454046404740484049",
        "4050405140524053405440554056405740584059",
        "4060406140624063406440654066406740684069",
        "4070407140724073407440754076407740784079",
        "4080408140824083408440854086408740884089",
        "4090409140924093409440954096409740984099",
        "4100410141024103410441054106410741084109",
        "4110411141124113411441154116411741184119",
        "4120412141224123412441254126412741284129",
        "4130413141324133413441354136413741384139",
        "4140414141424143414441454146414741484149",
        "4150415141524153415441554156415741584159",
        "4160416141624163416441654166416741684169",
        "4170417141724173417441754176417741784179",
        "4180418141824183418441854186418741884189",
        "4190419141924193419441954196419741984199",
        "4200420142024203420442054206420742084209",
        "4210421142124213421442154216421742184219",
        "4220422142224223422442254226422742284229",
        "4230423142324233423442354236423742384239",
        "4240424142424243424442454246424742484249",
        "4250425142524253425442554256425742584259",
        "4260426142624263426442654266426742684269",
        "4270427142724273427442754276427742784279",
        "4280428142824283428442854286428742884289",
        "4290429142924293429442954296429742984299",
        "4300430143024303430443054306430743084309",
        "4310431143124313431443154316431743184319",
        "4320432143224323432443254326432743284329",
        "4330433143324333433443354336433743384339",
        "4340434143424343434443454346434743484349",
        "4350435143524353435443554356435743584359",
        "4360436143624363436443654366436743684369",
        "4370437143724373437443754376437743784379",
        "4380438143824383438443854386438743884389",
        "4390439143924393439443954396439743984399",
        "4400440144024403440444054406440744084409",
        "4410441144124413441444154416441744184419",
        "4420442144224423442444254426442744284429",
        "4430443144324433443444354436443744384439",
        "4440444144424443444444454446444744484449",
        "4450445144524453445444554456445744584459",
        "4460446144624463446444654466446744684469",
        "4470447144724473447444754476447744784479",
        "4480448144824483448444854486448744884489",
        "4490449144924493449444954496449744984499",
        "4500450145024503450445054506450745084509",
        "4510451145124513451445154516451745184519",
        "4520452145224523452445254526452745284529",
        "4530453145324533453445354536453745384539",
        "4540454145424543454445454546454745484549",
        "4550455145524553455445554556455745584559",
        "4560456145624563456445654566456745684569",
        "4570457145724573457445754576457745784579",
        "4580458145824583458445854586458745884589",
        "4590459145924593459445954596459745984599",
        "4600460146024603460446054606460746084609",
        "4610461146124613461446154616461746184619",
        "4620462146224623462446254626462746284629",
        "4630463146324633463446354636463746384639",
        "4640464146424643464446454646464746484649",
        "4650465146524653465446554656465746584659",
        "4660466146624663466446654666466746684669",
        "4670467146724673467446754676467746784679",
        "4680468146824683468446854686468746884689",
        "4690469146924693469446954696469746984699",
        "4700470147024703470447054706470747084709",
        "4710471147124713471447154716471747184719",
        "4720472147224723472447254726472747284729",
        "4730473147324733473447354736473747384739",
        "4740474147424743474447454746474747484749",
        "4750475147524753475447554756475747584759",
        "4760476147624763476447654766476747684769",
        "4770477147724773477447754776477747784779",
        "4780478147824783478447854786478747884789",
        "4790479147924793479447954796479747984799",
        "4800480148024803480448054806480748084809",
        "4810481148124813481448154816481748184819",
        "4820482148224823482448254826482748284829",
        "4830483148324833483448354836483748384839",
        "4840484148424843484448454846484748484849",
        "4850485148524853485448554856485748584859",
        "4860486148624863486448654866486748684869",
        "4870487148724873487448754876487748784879",
        "4880488148824883488448854886488748884889",
        "4890489148924893489448954896489748984899",
        "4900490149024903490449054906490749084909",
        "4910491149124913491449154916491749184919",
        "4920492149224923492449254926492749284929",
        "4930493149324933493449354936493749384939",
        "4940494149424943494449454946494749484949",
        "4950495149524953495449554956495749584959",
        "4960496149624963496449654966496749684969",
        "4970497149724973497449754976497749784979",
        "4980498149824983498449854986498749884989",
        "4990499149924993499449954996499749984999",
        "5000500150025003500450055006500750085009",
        "5010501150125013501450155016501750185019",
        "5020502150225023502450255026502750285029",
        "5030503150325033503450355036503750385039",
        "5040504150425043504450455046504750485049",
        "5050505150525053505450555056505750585059",
        "5060506150625063506450655066506750685069",
        "5070507150725073507450755076507750785079",
        "5080508150825083508450855086508750885089",
        "5090509150925093509450955096509750985099",
        "5100510151025103510451055106510751085109",
        "5110511151125113511451155116511751185119",
        "5120512151225123512451255126512751285129",
        "5130513151325133513451355136513751385139",
        "5140514151425143514451455146514751485149",
        "5150515151525153515451555156515751585159",
        "5160516151625163516451655166516751685169",
        "5170517151725173517451755176517751785179",
        "5180518151825183518451855186518751885189",
        "5190519151925193519451955196519751985199",
        "5200520152025203520452055206520752085209",
        "5210521152125213521452155216521752185219",
        "5220522152225223522452255226522752285229",
        "5230523152325233523452355236523752385239",
        "5240524152425243524452455246524752485249",
        "5250525152525253525452555256525752585259",
        "5260526152625263526452655266526752685269",
        "5270527152725273527452755276527752785279",
        "5280528152825283528452855286528752885289",
        "5290529152925293529452955296529752985299",
        "5300530153025303530453055306530753085309",
        "5310531153125313531453155316531753185319",
        "5320532153225323532453255326532753285329",
        "5330533153325333533453355336533753385339",
        "5340534153425343534453455346534753485349",
        "5350535153525353535453555356535753585359",
        "5360536153625363536453655366536753685369",
        "5370537153725373537453755376537753785379",
        "5380538153825383538453855386538753885389",
        "5390539153925393539453955396539753985399",
        "5400540154025403540454055406540754085409",
        "5410541154125413541454155416541754185419",
        "5420542154225423542454255426542754285429",
        "5430543154325433543454355436543754385439",
        "5440544154425443544454455446544754485449",
        "5450545154525453545454555456545754585459",
        "5460546154625463546454655466546754685469",
        "5470547154725473547454755476547754785479",
        "5480548154825483548454855486548754885489",
        "5490549154925493549454955496549754985499",
        "5500550155025503550455055506550755085509",
        "5510551155125513551455155516551755185519",
        "5520552155225523552455255526552755285529",
        "5530553155325533553455355536553755385539",
        "5540554155425543554455455546554755485549",
        "5550555155525553555455555556555755585559",
        "5560556155625563556455655566556755685569",
        "5570557155725573557455755576557755785579",
        "5580558155825583558455855586558755885589",
        "5590559155925593559455955596559755985599",
        "5600560156025603560456055606560756085609",
        "5610561156125613561456155616561756185619",
        "5620562156225623562456255626562756285629",
        "5630563156325633563456355636563756385639",
        "5640564156425643564456455646564756485649",
        "5650565156525653565456555656565756585659",
        "5660566156625663566456655666566756685669",
        "5670567156725673567456755676567756785679",
        "5680568156825683568456855686568756885689",
        "5690569156925693569456955696569756985699",
        "5700570157025703570457055706570757085709",
        "5710571157125713571457155716571757185719",
        "5720572157225723572457255726572757285729",
        "5730573157325733573457355736573757385739",
        "5740574157425743574457455746574757485749",
        "5750575157525753575457555756575757585759",
        "5760576157625763576457655766576757685769",
        "5770577157725773577457755776577757785779",
        "5780578157825783578457855786578757885789",
        "5790579157925793579457955796579757985799",
        "5800580158025803580458055806580758085809",
        "5810581158125813581458155816581758185819",
        "5820582158225823582458255826582758285829",
        "5830583158325833583458355836583758385839",
        "5840584158425843584458455846584758485849",
        "5850585158525853585458555856585758585859",
        "5860586158625863586458655866586758685869",
        "5870587158725873587458755876587758785879",
        "5880588158825883588458855886588758885889",
        "5890589158925893589458955896589758985899",
        "5900590159025903590459055906590759085909",
        "5910591159125913591459155916591759185919",
        "5920592159225923592459255926592759285929",
        "5930593159325933593459355936593759385939",
        "5940594159425943594459455946594759485949",
        "5950595159525953595459555956595759585959",
        "5960596159625963596459655966596759685969",
        "5970597159725973597459755976597759785979",
        "5980598159825983598459855986598759885989",
        "5990599159925993599459955996599759985999",
        "6000600160026003600460056006600760086009",
        "6010601160126013601460156016601760186019",
        "6020602160226023602460256026602760286029",
        "6030603160326033603460356036603760386039",
        "6040604160426043604460456046604760486049",
        "6050605160526053605460556056605760586059",
        "6060606160626063606460656066606760686069",
        "6070607160726073607460756076607760786079",
        "6080608160826083608460856086608760886089",
        "6090609160926093609460956096609760986099",
        "6100610161026103610461056106610761086109",
        "6110611161126113611461156116611761186119",
        "6120612161226123612461256126612761286129",
        "6130613161326133613461356136613761386139",
        "6140614161426143614461456146614761486149",
        "6150615161526153615461556156615761586159",
        "6160616161626163616461656166616761686169",
        "6170617161726173617461756176617761786179",
        "6180618161826183618461856186618761886189",
        "6190619161926193619461956196619761986199",
        "6200620162026203620462056206620762086209",
        "6210621162126213621462156216621762186219",
        "6220622162226223622462256226622762286229",
        "6230623162326233623462356236623762386239",
        "6240624162426243624462456246624762486249",
        "6250625162526253625462556256625762586259",
        "6260626162626263626462656266626762686269",
        "6270627162726273627462756276627762786279",
        "6280628162826283628462856286628762886289",
        "6290629162926293629462956296629762986299",
        "6300630163026303630463056306630763086309",
        "6310631163126313631463156316631763186319",
        "6320632163226323632463256326632763286329",
        "6330633163326333633463356336633763386339",
        "6340634163426343634463456346634763486349",
        "6350635163526353635463556356635763586359",
        "6360636163626363636463656366636763686369",
        "6370637163726373637463756376637763786379",
        "6380638163826383638463856386638763886389",
        "6390639163926393639463956396639763986399",
        "6400640164026403640464056406640764086409",
        "6410641164126413641464156416641764186419",
        "6420642164226423642464256426642764286429",
        "6430643164326433643464356436643764386439",
        "6440644164426443644464456446644764486449",
        "6450645164526453645464556456645764586459",
        "6460646164626463646464656466646764686469",
        "6470647164726473647464756476647764786479",
        "6480648164826483648464856486648764886489",
        "6490649164926493649464956496649764986499",
        "6500650165026503650465056506650765086509",
        "6510651165126513651465156516651765186519",
        "6520652165226523652465256526652765286529",
        "6530653165326533653465356536653765386539",
        "6540654165426543654465456546654765486549",
        "6550655165526553655465556556655765586559",
        "6560656165626563656465656566656765686569",
        "6570657165726573657465756576657765786579",
        "6580658165826583658465856586658765886589",
        "6590659165926593659465956596659765986599",
        "6600660166026603660466056606660766086609",
        "6610661166126613661466156616661766186619",
        "6620662166226623662466256626662766286629",
        "6630663166326633663466356636663766386639",
        "6640664166426643664466456646664766486649",
        "6650665166526653665466556656665766586659",
        "6660666166626663666466656666666766686669",
        "6670667166726673667466756676667766786679",
        "6680668166826683668466856686668766886689",
        "6690669166926693669466956696669766986699",
        "6700670167026703670467056706670767086709",
        "6710671167126713671467156716671767186719",
        "6720672167226723672467256726672767286729",
        "6730673167326733673467356736673767386739",
        "6740674167426743674467456746674767486749",
        "6750675167526753675467556756675767586759",
        "6760676167626763676467656766676767686769",
        "6770677167726773677467756776677767786779",
        "6780678167826783678467856786678767886789",
        "6790679167926793679467956796679767986799",
        "6800680168026803680468056806680768086809",
        "6810681168126813681468156816681768186819",
        "6820682168226823682468256826682768286829",
        "6830683168326833683468356836683768386839",
        "6840684168426843684468456846684768486849",
        "6850685168526853685468556856685768586859",
        "6860686168626863686468656866686768686869",
        "6870687168726873687468756876687768786879",
        "6880688168826883688468856886688768886889",
        "6890689168926893689468956896689768986899",
        "6900690169026903690469056906690769086909",
        "6910691169126913691469156916691769186919",
        "6920692169226923692469256926692769286929",
        "6930693169326933693469356936693769386939",
        "6940694169426943694469456946694769486949",
        "6950695169526953695469556956695769586959",
        "6960696169626963696469656966696769686969",
        "6970697169726973697469756976697769786979",
        "6980698169826983698469856986698769886989",
        "6990699169926993699469956996699769986999",
        "7000700170027003700470057006700770087009",
        "7010701170127013701470157016701770187019",
        "7020702170227023702470257026702770287029",
        "7030703170327033703470357036703770387039",
        "7040704170427043704470457046704770487049",
        "7050705170527053705470557056705770587059",
        "7060706170627063706470657066706770687069",
        "7070707170727073707470757076707770787079",
        "7080708170827083708470857086708770887089",
        "7090709170927093709470957096709770987099",
        "7100710171027103710471057106710771087109",
        "7110711171127113711471157116711771187119",
        "7120712171227123712471257126712771287129",
        "7130713171327133713471357136713771387139",
        "7140714171427143714471457146714771487149",
        "7150715171527153715471557156715771587159",
        "7160716171627163716471657166716771687169",
        "7170717171727173717471757176717771787179",
        "7180718171827183718471857186718771887189",
        "7190719171927193719471957196719771987199",
        "7200720172027203720472057206720772087209",
        "7210721172127213721472157216721772187219",
        "7220722172227223722472257226722772287229",
        "7230723172327233723472357236723772387239",
        "7240724172427243724472457246724772487249",
        "7250725172527253725472557256725772587259",
        "7260726172627263726472657266726772687269",
        "7270727172727273727472757276727772787279",
        "7280728172827283728472857286728772887289",
        "7290729172927293729472957296729772987299",
        "7300730173027303730473057306730773087309",
        "7310731173127313731473157316731773187319",
        "7320732173227323732473257326732773287329",
        "7330733173327333733473357336733773387339",
        "7340734173427343734473457346734773487349",
        "7350735173527353735473557356735773587359",
        "7360736173627363736473657366736773687369",
        "7370737173727373737473757376737773787379",
        "7380738173827383738473857386738773887389",
        "7390739173927393739473957396739773987399",
        "7400740174027403740474057406740774087409",
        "7410741174127413741474157416741774187419",
        "7420742174227423742474257426742774287429",
        "7430743174327433743474357436743774387439",
        "7440744174427443744474457446744774487449",
        "7450745174527453745474557456745774587459",
        "7460746174627463746474657466746774687469",
        "7470747174727473747474757476747774787479",
        "7480748174827483748474857486748774887489",
        "7490749174927493749474957496749774987499",
        "7500750175027503750475057506750775087509",
        "7510751175127513751475157516751775187519",
        "7520752175227523752475257526752775287529",
        "7530753175327533753475357536753775387539",
        "7540754175427543754475457546754775487549",
        "7550755175527553755475557556755775587559",
        "7560756175627563756475657566756775687569",
        "7570757175727573757475757576757775787579",
        "7580758175827583758475857586758775887589",
        "7590759175927593759475957596759775987599",
        "7600760176027603760476057606760776087609",
        "7610761176127613761476157616761776187619",
        "7620762176227623762476257626762776287629",
        "7630763176327633763476357636763776387639",
        "7640764176427643764476457646764776487649",
        "7650765176527653765476557656765776587659",
        "7660766176627663766476657666766776687669",
        "7670767176727673767476757676767776787679",
        "7680768176827683768476857686768776887689",
        "7690769176927693769476957696769776987699",
        "7700770177027703770477057706770777087709",
        "7710771177127713771477157716771777187719",
        "7720772177227723772477257726772777287729",
        "7730773177327733773477357736773777387739",
        "7740774177427743774477457746774777487749",
        "7750775177527753775477557756775777587759",
        "7760776177627763776477657766776777687769",
        "7770777177727773777477757776777777787779",
        "7780778177827783778477857786778777887789",
        "7790779177927793779477957796779777987799",
        "7800780178027803780478057806780778087809",
        "7810781178127813781478157816781778187819",
        "7820782178227823782478257826782778287829",
        "7830783178327833783478357836783778387839",
        "7840784178427843784478457846784778487849",
        "7850785178527853785478557856785778587859",
        "7860786178627863786478657866786778687869",
        "7870787178727873787478757876787778787879",
        "7880788178827883788478857886788778887889",
        "7890789178927893789478957896789778987899",
        "7900790179027903790479057906790779087909",
        "7910791179127913791479157916791779187919",
        "7920792179227923792479257926792779287929",
        "7930793179327933793479357936793779387939",
        "7940794179427943794479457946794779487949",
        "7950795179527953795479557956795779587959",
        "7960796179627963796479657966796779687969",
        "7970797179727973797479757976797779787979",
        "7980798179827983798479857986798779887989",
        "7990799179927993799479957996799779987999",
        "8000800180028003800480058006800780088009",
        "8010801180128013801480158016801780188019",
        "8020802180228023802480258026802780288029",
        "8030803180328033803480358036803780388039",
        "8040804180428043804480458046804780488049",
        "8050805180528053805480558056805780588059",
        "8060806180628063806480658066806780688069",
        "8070807180728073807480758076807780788079",
        "8080808180828083808480858086808780888089",
        "8090809180928093809480958096809780988099",
        "8100810181028103810481058106810781088109",
        "8110811181128113811481158116811781188119",
        "8120812181228123812481258126812781288129",
        "8130813181328133813481358136813781388139",
        "8140814181428143814481458146814781488149",
        "8150815181528153815481558156815781588159",
        "8160816181628163816481658166816781688169",
        "8170817181728173817481758176817781788179",
        "8180818181828183818481858186818781888189",
        "8190819181928193819481958196819781988199",
        "8200820182028203820482058206820782088209",
        "8210821182128213821482158216821782188219",
        "8220822182228223822482258226822782288229",
        "8230823182328233823482358236823782388239",
        "8240824182428243824482458246824782488249",
        "8250825182528253825482558256825782588259",
        "8260826182628263826482658266826782688269",
        "8270827182728273827482758276827782788279",
        "8280828182828283828482858286828782888289",
        "8290829182928293829482958296829782988299",
        "8300830183028303830483058306830783088309",
        "8310831183128313831483158316831783188319",
        "8320832183228323832483258326832783288329",
        "8330833183328333833483358336833783388339",
        "8340834183428343834483458346834783488349",
        "8350835183528353835483558356835783588359",
        "8360836183628363836483658366836783688369",
        "8370837183728373837483758376837783788379",
        "8380838183828383838483858386838783888389",
        "8390839183928393839483958396839783988399",
        "8400840184028403840484058406840784088409",
        "8410841184128413841484158416841784188419",
        "8420842184228423842484258426842784288429",
        "8430843184328433843484358436843784388439",
        "8440844184428443844484458446844784488449",
        "8450845184528453845484558456845784588459",
        "8460846184628463846484658466846784688469",
        "8470847184728473847484758476847784788479",
        "8480848184828483848484858486848784888489",
        "8490849184928493849484958496849784988499",
        "8500850185028503850485058506850785088509",
        "8510851185128513851485158516851785188519",
        "8520852185228523852485258526852785288529",
        "8530853185328533853485358536853785388539",
        "8540854185428543854485458546854785488549",
        "8550855185528553855485558556855785588559",
        "8560856185628563856485658566856785688569",
        "8570857185728573857485758576857785788579",
        "8580858185828583858485858586858785888589",
        "8590859185928593859485958596859785988599",
        "8600860186028603860486058606860786088609",
        "8610861186128613861486158616861786188619",
        "8620862186228623862486258626862786288629",
        "8630863186328633863486358636863786388639",
        "8640864186428643864486458646864786488649",
        "8650865186528653865486558656865786588659",
        "8660866186628663866486658666866786688669",
        "8670867186728673867486758676867786788679",
        "8680868186828683868486858686868786888689",
        "8690869186928693869486958696869786988699",
        "8700870187028703870487058706870787088709",
        "8710871187128713871487158716871787188719",
        "8720872187228723872487258726872787288729",
        "8730873187328733873487358736873787388739",
        "8740874187428743874487458746874787488749",
        "8750875187528753875487558756875787588759",
        "8760876187628763876487658766876787688769",
        "8770877187728773877487758776877787788779",
        "8780878187828783878487858786878787888789",
        "8790879187928793879487958796879787988799",
        "8800880188028803880488058806880788088809",
        "8810881188128813881488158816881788188819",
        "8820882188228823882488258826882788288829",
        "8830883188328833883488358836883788388839",
        "8840884188428843884488458846884788488849",
        "8850885188528853885488558856885788588859",
        "8860886188628863886488658866886788688869",
        "8870887188728873887488758876887788788879",
        "8880888188828883888488858886888788888889",
        "8890889188928893889488958896889788988899",
        "8900890189028903890489058906890789088909",
        "8910891189128913891489158916891789188919",
        "8920892189228923892489258926892789288929",
        "8930893189328933893489358936893789388939",
        "8940894189428943894489458946894789488949",
        "8950895189528953895489558956895789588959",
        "8960896189628963896489658966896789688969",
        "8970897189728973897489758976897789788979",
        "8980898189828983898489858986898789888989",
        "8990899189928993899489958996899789988999",
        "9000900190029003900490059006900790089009",
        "9010901190129013901490159016901790189019",
        "9020902190229023902490259026902790289029",
        "9030903190329033903490359036903790389039",
        "9040904190429043904490459046904790489049",
        "9050905190529053905490559056905790589059",
        "9060906190629063906490659066906790689069",
        "9070907190729073907490759076907790789079",
        "9080908190829083908490859086908790889089",
        "9090909190929093909490959096909790989099",
        "9100910191029103910491059106910791089109",
        "9110911191129113911491159116911791189119",
        "9120912191229123912491259126912791289129",
        "9130913191329133913491359136913791389139",
        "9140914191429143914491459146914791489149",
        "9150915191529153915491559156915791589159",
        "9160916191629163916491659166916791689169",
        "9170917191729173917491759176917791789179",
        "9180918191829183918491859186918791889189",
        "9190919191929193919491959196919791989199",
        "9200920192029203920492059206920792089209",
        "9210921192129213921492159216921792189219",
        "9220922192229223922492259226922792289229",
        "9230923192329233923492359236923792389239",
        "9240924192429243924492459246924792489249",
        "9250925192529253925492559256925792589259",
        "9260926192629263926492659266926792689269",
        "9270927192729273927492759276927792789279",
        "9280928192829283928492859286928792889289",
        "9290929192929293929492959296929792989299",
        "9300930193029303930493059306930793089309",
        "9310931193129313931493159316931793189319",
        "9320932193229323932493259326932793289329",
        "9330933193329333933493359336933793389339",
        "9340934193429343934493459346934793489349",
        "9350935193529353935493559356935793589359",
        "9360936193629363936493659366936793689369",
        "9370937193729373937493759376937793789379",
        "9380938193829383938493859386938793889389",
        "9390939193929393939493959396939793989399",
        "9400940194029403940494059406940794089409",
        "9410941194129413941494159416941794189419",
        "9420942194229423942494259426942794289429",
        "9430943194329433943494359436943794389439",
        "9440944194429443944494459446944794489449",
        "9450945194529453945494559456945794589459",
        "9460946194629463946494659466946794689469",
        "9470947194729473947494759476947794789479",
        "9480948194829483948494859486948794889489",
        "9490949194929493949494959496949794989499",
        "9500950195029503950495059506950795089509",
        "9510951195129513951495159516951795189519",
        "9520952195229523952495259526952795289529",
        "9530953195329533953495359536953795389539",
        "9540954195429543954495459546954795489549",
        "9550955195529553955495559556955795589559",
        "9560956195629563956495659566956795689569",
        "9570957195729573957495759576957795789579",
        "9580958195829583958495859586958795889589",
        "9590959195929593959495959596959795989599",
        "9600960196029603960496059606960796089609",
        "9610961196129613961496159616961796189619",
        "9620962196229623962496259626962796289629",
        "9630963196329633963496359636963796389639",
        "9640964196429643964496459646964796489649",
        "9650965196529653965496559656965796589659",
        "9660966196629663966496659666966796689669",
        "9670967196729673967496759676967796789679",
        "9680968196829683968496859686968796889689",
        "9690969196929693969496959696969796989699",
        "9700970197029703970497059706970797089709",
        "9710971197129713971497159716971797189719",
        "9720972197229723972497259726972797289729",
        "9730973197329733973497359736973797389739",
        "9740974197429743974497459746974797489749",
        "9750975197529753975497559756975797589759",
        "9760976197629763976497659766976797689769",
        "9770977197729773977497759776977797789779",
        "9780978197829783978497859786978797889789",
        "9790979197929793979497959796979797989799",
        "9800980198029803980498059806980798089809",
        "9810981198129813981498159816981798189819",
        "9820982198229823982498259826982798289829",
        "9830983198329833983498359836983798389839",
        "9840984198429843984498459846984798489849",
        "9850985198529853985498559856985798589859",
        "9860986198629863986498659866986798689869",
        "9870987198729873987498759876987798789879",
        "9880988198829883988498859886988798889889",
        "9890989198929893989498959896989798989899",
        "9900990199029903990499059906990799089909",
        "9910991199129913991499159916991799189919",
        "9920992199229923992499259926992799289929",
        "9930993199329933993499359936993799389939",
        "9940994199429943994499459946994799489949",
        "9950995199529953995499559956995799589959",
        "9960996199629963996499659966996799689969",
        "9970997199729973997499759976997799789979",
        "9980998199829983998499859986998799889989",
        "9990999199929993999499959996999799989999"
        };

        static char* cstItoa = (char*)Marshal.StringToHGlobalAuto(String.Join(string.Empty, digits_string)).ToPointer();

        private static unsafe void memcpy(char* dmem, char* smem, int charCount) {
            if ((((int)dmem) & 2) != 0) {
                dmem[0] = smem[0];
                dmem++;
                smem++;
                charCount--;
            }
            while (charCount >= 8) {
                *((int*)dmem) = *((int*)smem);
                *((int*)(dmem + 2)) = *((int*)(smem + 2));
                *((int*)(dmem + 4)) = *((int*)(smem + 4));
                *((int*)(dmem + 6)) = *((int*)(smem + 6));
                dmem += 8;
                smem += 8;
                charCount -= 8;
            }
            if ((charCount & 4) != 0) {
                *((int*)dmem) = *((int*)smem);
                *((int*)(dmem + 2)) = *((int*)(smem + 2));
                dmem += 4;
                smem += 4;
            }
            if ((charCount & 2) != 0) {
                *((int*)dmem) = *((int*)smem);
                dmem += 2;
                smem += 2;
            }
            if ((charCount & 1) != 0) {
                dmem[0] = smem[0];
            }
        }

        static int ilog_10(uint aI) {
            if (aI == 0) return 0;
            else if (aI >= 1 && aI <= 9) return 1;
            else if (aI >= 10 && aI <= 99) return 2;
            else if (aI >= 100 && aI <= 999) return 3;

            else if (aI >= 1000 && aI <= 9999) return 4;

            else if (aI >= 10000 && aI <= 99999) return 5;

            else if (aI >= 100000 && aI <= 999999) return 6;

            else if (aI >= 1000000 && aI <= 9999999) return 7;
            else if (aI >= 10000000 && aI <= 99999999) return 8;
            else if (aI >= 100000000 && aI <= 999999999) return 9;

            return 10;
        }

        static int lllog_10(ulong aI) {
            if (aI == 0) return 0;
            else if (aI >= 1 && aI <= 9) return 1;
            else if (aI >= 10 && aI <= 99) return 2;
            else if (aI >= 100 && aI <= 999) return 3;

            else if (aI >= 1000 && aI <= 9999) return 4;

            else if (aI >= 10000 && aI <= 99999) return 5;

            else if (aI >= 100000 && aI <= 999999) return 6;

            else if (aI >= 1000000 && aI <= 9999999) return 7;
            else if (aI >= 10000000 && aI <= 99999999) return 8;
            else if (aI >= 100000000 && aI <= 999999999) return 9;

            else if (aI >= 1000000000 && aI <= 9999999999) return 10;
            else if (aI >= 10000000000 && aI <= 99999999999) return 11;
            else if (aI >= 100000000000 && aI <= 999999999999) return 12;
            else if (aI >= 1000000000000 && aI <= 9999999999999) return 13;
            else if (aI >= 10000000000000 && aI <= 99999999999999) return 14;
            else if (aI >= 100000000000000 && aI <= 999999999999999) return 15;
            else if (aI >= 1000000000000000 && aI <= 9999999999999999) return 16;
            else if (aI >= 10000000000000000 && aI <= 99999999999999999) return 17;
            else if (aI >= 100000000000000000 && aI <= 999999999999999999) return 18;
            else if (aI >= 1000000000000000000 && aI <= 9999999999999999999) return 19;
            else if (aI >= 10000000000000000000 && aI <= 9) return 20;

            return 19 + ((aI >= 10000000000000000000UL) ? 1 : 0);
        }

        static string ustoa(char* aBuf, ushort aShort) {
            ushort tmpShort = aShort > 9999 ? (ushort)(aShort / 10) : aShort;

            char* src = cstItoa + ATOI_TAB_SZ_LOG * tmpShort;
            if (tmpShort >= 1000 && tmpShort <= 9999) *aBuf++ = src[0];
            else if (tmpShort >= 100 && tmpShort <= 999) *aBuf++ = src[1];
            else if (tmpShort >= 10 && tmpShort <= 99) *aBuf++ = src[2];
            else if (tmpShort >= 0 && tmpShort <= 9) *aBuf++ = src[3];

            if (tmpShort != aShort) {
                char tmpRem = (char)(aShort % 10);
                *aBuf++ = (char)(tmpRem + '0');
            }
            *aBuf = '\0';
            return new string(aBuf);
        }

        static string stoa(char* aBuf, short aShort) {
            if (aShort < 0) {
                *aBuf++ = '-';
                aShort = (short)-aShort;
            };
            return ustoa(aBuf, (ushort)aShort);
        }

        static void uitoa_core(char* targetPtr, uint anInt) {
            while (anInt >= ATOI_TAB_SZ) {
                uint myDiv10000 = (uint)(anInt / ATOI_TAB_SZ);
                targetPtr -= 4;
                memcpy(targetPtr, cstItoa + ATOI_TAB_SZ_LOG * (anInt % ATOI_TAB_SZ), 4);
                anInt = myDiv10000;
            }

            char* myTabPtr = cstItoa + (ATOI_TAB_SZ_LOG - 1) + ATOI_TAB_SZ_LOG * anInt;

            if (anInt >= 100 && anInt <= 999) *(--targetPtr) = *myTabPtr--;
            else if (anInt >= 10 && anInt <= 99) *(--targetPtr) = *myTabPtr--;
            //else if (anInt >= 0 && anInt <= 9) *(--targetPtr) = *myTabPtr;
            //else *(--targetPtr) = *myTabPtr--;

        }

        static char* uitoa_general(char* aBuf, uint anInt) {
            /* Points after the last digit of the number. */
            aBuf += ilog_10(anInt);

            uitoa_core(aBuf, anInt);

            *aBuf = '\0';
            return aBuf;
        }

        static char* uitoa(char* aBuf, uint anInt) {
            char* src = cstItoa + ATOI_TAB_SZ_LOG * anInt;

            if (anInt >= 1000 && anInt <= 9999) *aBuf++ = src[0];
            if (anInt >= 100 && anInt <= 999) *aBuf++ = src[1];
            else if (anInt >= 10 && anInt <= 99) *aBuf++ = src[2];
            else if (anInt >= 0 && anInt <= 9) {
                *aBuf++ = src[3];
                *aBuf = '\0';
                return aBuf;
            }
            return uitoa_general(aBuf, anInt);
        }


        static char* uitoa2_core(char* aBuf, uint anInt) {
            char* src = cstItoa + ATOI_TAB_SZ_LOG * anInt;

            if (anInt >= 100 && anInt <= 999) *aBuf++ = src[1];
            else if (anInt >= 10 && anInt <= 99) *aBuf++ = src[2];
            else if (anInt >= 0 && anInt <= 9) *aBuf++ = src[3];
            else *aBuf++ = src[0];
            return aBuf;
        }

        static char* uitoa2_general(char* aBuf, uint anInt) {
            uint tmpInt = anInt / 10000;
            if (anInt < 100000000)
                aBuf = uitoa2_core(aBuf, tmpInt);
            else
                aBuf = uitoa2_general(aBuf, tmpInt);

            memcpy(aBuf, cstItoa + (anInt % 10000) * ATOI_TAB_SZ_LOG, 4);
            return aBuf + 4;
        }

        static char* uitoa2(char* aBuf, uint anInt) {
            char* src = cstItoa + ATOI_TAB_SZ_LOG * anInt;

            if (anInt >= 1000 && anInt <= 9999) *aBuf++ = src[0];
            else if (anInt >= 100 && anInt <= 999) *aBuf++ = src[1];
            else if (anInt >= 10 && anInt <= 99) *aBuf++ = src[2];
            else if (anInt >= 0 && anInt <= 9) {
                *aBuf++ = src[3]; *aBuf = '\0';
                return aBuf;
            }
            aBuf = uitoa2_general(aBuf, anInt);
            *aBuf = '\0';
            return aBuf;
        }

        static char* itoa(char* aBuf, int anInt) {
            if (anInt < 0) {
                *aBuf++ = '-';
                anInt = -anInt;
            };
            return uitoa(aBuf, (uint)anInt);
        }

        const ulong ULONG_MAX = 1;

        static char* ulltoa_general(char* aBuf, ulong aLL) {
            /* Points after the last digit of the number. */
            aBuf += lllog_10(aLL);
            //char* myPtr = aBuf;

            /* First div64 bits, then later 32 bits only. */
            while (aLL >= ULONG_MAX) {

                /* See div64_32 in Linux internals, for fast division. */
                ulong myDiv10000 = aLL / ATOI_TAB_SZ;
                aBuf -= 4;
                memcpy(aBuf, cstItoa + ATOI_TAB_SZ_LOG * (uint)(aLL % ATOI_TAB_SZ), 4);
                aLL = myDiv10000;

            };

            /* 32 bits only. */
            uitoa_core(aBuf, (uint)aLL);

            //aBuf = myPtr;
            //*aBuf = '\0';
            return aBuf;
        }

        static string convertToStr(char* buf) {
            return new string(buf);
        }

        static char* ulltoa(char* aBuf, ulong aLL) {
            char* src = cstItoa + ATOI_TAB_SZ_LOG * aLL;

            if (aLL >= 1000 && aLL <= 9999) *aBuf++ = src[0];
            //else if (aLL >= 100 && aLL <= 999) *aBuf++ = src[1];
            //else if (aLL >= 10 && aLL <= 99) *aBuf++ = src[2];
            else if (aLL >= 0 && aLL <= 9) {
                *aBuf++ = src[3]; *aBuf = '\0';
                return aBuf;
            }

            return ulltoa_general(aBuf, aLL);
        }

        static char* ulltoa2_core(char* aBuf, ulong aLL) {
            char* src = cstItoa + ATOI_TAB_SZ_LOG * aLL;
            if (aLL >= 100 && aLL <= 999) *aBuf++ = src[1];
            else if (aLL >= 10 && aLL <= 99) *aBuf++ = src[2];
            else if (aLL >= 0 && aLL <= 9) *aBuf++ = src[3];
            else *aBuf++ = src[0];
            return aBuf;
        }

        static char* ulltoa2_general(char* aBuf, ulong aLL) {
            ulong tmpLL = aLL / 10000;
            if (aLL < 100000000)
                aBuf = ulltoa2_core(aBuf, tmpLL);
            else
                aBuf = ulltoa2_general(aBuf, tmpLL);

            memcpy(aBuf, cstItoa + (aLL % 10000) * ATOI_TAB_SZ_LOG, 4);
            return aBuf + 4;
        }

        static char* ulltoa2(char* aBuf, ulong aLL) {
            char* src = cstItoa + ATOI_TAB_SZ_LOG * aLL;

            if (aLL >= 1000 && aLL <= 9999) *aBuf++ = src[0];
            else if (aLL >= 100 && aLL <= 999) *aBuf++ = src[1];
            else if (aLL >= 10 && aLL <= 99) *aBuf++ = src[2];
            else if (aLL >= 0 && aLL <= 9) {
                *aBuf++ = src[3]; *aBuf = '\0';
                return aBuf;
            }
            aBuf = ulltoa2_general(aBuf, aLL);
            *aBuf = '\0';
            return aBuf;
        }

        static char* ulltoa3(char* aBuf, ulong aLL) {
            if (aLL < ATOI_TAB_SZ_LOG) {
                return uitoa(aBuf, (uint)aLL);
            }
            return ulltoa_general(aBuf, aLL);
        }

        const int LLONG_DIGITS = 20;

        static int szBuf = LLONG_DIGITS + 1;

        static char* ulltoa4(char* aBuf, ulong aLL) {

            char* tmpBuf = stackalloc char[szBuf];

            char* ptrOrg = tmpBuf + szBuf;
            char* ptr = ptrOrg;
            long nbDigs;

            do {
                int rem = (int)(aLL % 10);
                *--ptr = (char)(rem + '0');
                aLL /= 10;
            } while (aLL != 0);


            nbDigs = ptrOrg - ptr;
            memcpy(aBuf, ptr, (int)nbDigs);
            aBuf += nbDigs;
            *aBuf = '\0';
            return aBuf;
        }

        static char* lltoa(char* aBuf, long aLL) {
            if (aLL < 0) {
                *aBuf++ = '-';
                aLL = -aLL;
            }
            return ulltoa(aBuf, (ulong)aLL);
        }

        static int biggestPowerOfTen = 1000000;

        static char* dtoa(char* aBuf, double aD) {
            double tmpTrunc = Math.Round(aD);
            int tmpTruncInt = (int)tmpTrunc;
            char* tmpRes = itoa(aBuf, tmpTruncInt);
            *tmpRes++ = '.';

            double tmpMantissa = (tmpTruncInt < 0) ? aD - tmpTrunc : tmpTrunc - aD;

            return uitoa(tmpRes, (uint)(biggestPowerOfTen * (int)tmpMantissa));
        }

        public static string ultoa(ulong value) {
            char* buf = stackalloc char[21];
            char* bf = buf;

            ulltoa(bf, value);

            return new string(bf);
        }

        public static string ltoa(long value) {
            char* buf = stackalloc char[20];
            char* bf = buf;
            lltoa(bf, value);
            //lltoa(buf, value);
            if (value < 0) {
                bf[0] = '-';
            }
            return new string(bf);
            //return new string(buf + (value >= 10 && value < 10000 ? 1 : 0));
        }

        public static string uitoa(uint value) {
            char* buf = stackalloc char[20];
            uitoa(buf, value);
            return new string(buf);
        }

        public static string itoa(int value) {
            char* buf = stackalloc char[11];
            itoa(buf, value);
            return new string(buf);
        }
    }
}
